{% extends "layout.html" %}
{% block content %}
<h2>Admin Dashboard</h2>
<div class="row">
  <div class="col-md-4"><div class="card p-3"><h5>Doctors</h5><p>{{ total_doctors }}</p></div></div>
  <div class="col-md-4"><div class="card p-3"><h5>Patients</h5><p>{{ total_patients }}</p></div></div>
  <div class="col-md-4"><div class="card p-3"><h5>Appointments</h5><p>{{ total_appointments }}</p></div></div>
</div>

<hr>
<h4>Recent Appointments</h4>
<table class="table">
  <thead><tr><th>ID</th><th>Doctor</th><th>Patient</th><th>Date</th><th>Time</th><th>Status</th></tr></thead>
  <tbody>
    {% for a in appointments %}
      <tr>
        <td>{{ a.id }}</td>
        <td>{{ a.doctor.full_name }}</td>
        <td>{{ a.patient.full_name }}</td>
        <td>{{ a.date }}</td>
        <td>{{ a.time.strftime("%H:%M") }}</td>
        <td>{{ a.status }}</td>
      </tr>
    {% endfor %}
  </tbody>
</table>
<div class="my-4">
  <div class="d-flex gap-2">
    <a href="{{ url_for('admin_doctors') }}" class="btn btn-primary">Manage Doctors</a>
    <a href="{{ url_for('admin_appointments') }}" class="btn btn-secondary">View All Appointments</a>
    <a href="{{ url_for('admin_patients') }}" class="btn btn-primary">View Patients</a>
  </div>
</div>
<div class="row">
  <div class="col-12">
    <div class="card mb-4">
      <div class="card-body text-center">
        {% if show_chart %}
          <div class="d-flex justify-content-center">
            <img src="{{ url_for('static', filename=chart_filename) }}" alt="Appointments chart" class="img-fluid" style="max-width:540px;">
          </div>
        {% else %}
          <div class="alert alert-info mb-0">No appointment data yet â€” pie chart will appear after appointments are created.</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>

{% endblock %}
